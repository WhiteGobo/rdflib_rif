@prefix ns1: <http://www.w3.org/2007/rif#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<http://example.com/2009/prd2CheckoutRuleset> a ns1:Group ;
    ns1:sentences ( <http://example.com/2009/prd2GoldRule> <http://example.com/2009/prd2DiscountRule> <http://example.com/2009/prd2NewCustomerAndWidgetRule> <http://example.com/2009/prd2UnknownStatusRule> ) .

<http://example.com/2009/prd2DiscountRule> a ns1:Group ;
    ns1:sentences ( [ a ns1:Forall ;
                ns1:formula <http://example.com/2009/prd2IfMedalDoDiscount> ;
                ns1:pattern [ a ns1:Member ;
                        ns1:class [ a ns1:Const ;
                                ns1:constIRI "http://example.com/2009/prd2Customer"^^xsd:anyURI ] ;
                        ns1:instance [ a ns1:Var ;
                                ns1:varname "customer" ] ] ;
                ns1:vars ( [ a ns1:Var ;
                            ns1:varname "customer" ] ) ] ) .

<http://example.com/2009/prd2GoldRule> a ns1:Group ;
    ns1:sentences ( [ a ns1:Forall ;
                ns1:formula [ a ns1:Forall ;
                        ns1:formula <http://example.com/2009/prd2IfBigValueMakeGold> ;
                        ns1:pattern [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "customer" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2shoppingCart"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Var ;
                                                    ns1:varname "shoppingCart" ] ] ) ] ;
                        ns1:vars ( [ a ns1:Var ;
                                    ns1:varname "shoppingCart" ] ) ] ;
                ns1:pattern [ a ns1:And ;
                        ns1:formulas ( [ a ns1:Member ;
                                    ns1:class [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2Customer"^^xsd:anyURI ] ;
                                    ns1:instance [ a ns1:Var ;
                                            ns1:varname "customer" ] ] [ a ns1:Frame ;
                                    ns1:object [ a ns1:Var ;
                                            ns1:varname "customer" ] ;
                                    ns1:slots ( [ a ns1:Slot ;
                                                ns1:slotkey [ a ns1:Const ;
                                                        ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                                ns1:slotvalue [ a ns1:Const ;
                                                        ns1:value "Silver"^^xsd:string ] ] ) ] ) ] ;
                ns1:vars ( [ a ns1:Var ;
                            ns1:varname "customer" ] ) ] ) .

<http://example.com/2009/prd2IfBigValueMakeGold> a ns1:Implies ;
    ns1:if [ a ns1:Exists ;
            ns1:formula [ a ns1:And ;
                    ns1:formulas ( [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "shoppingCart" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2value"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Var ;
                                                    ns1:varname "value" ] ] ) ] [ a ns1:External ;
                                ns1:content [ a ns1:Atom ;
                                        ns1:args ( [ a ns1:Var ;
                                                    ns1:varname "value" ] [ a ns1:Const ;
                                                    ns1:value 2000 ] ) ;
                                        ns1:op [ a ns1:Const ;
                                                ns1:constIRI "http://www.w3.org/2007/rif-builtin-predicate#numeric-greater-than-or-equal"^^xsd:anyURI ] ] ] ) ] ;
            ns1:vars ( [ a ns1:Var ;
                        ns1:varname "value" ] ) ] ;
    ns1:then [ a ns1:Do ;
            ns1:actions ( [ a ns1:Modify ;
                        ns1:target [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "customer" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Const ;
                                                    ns1:value "Gold"^^xsd:string ] ] ) ] ] ) ] .

<http://example.com/2009/prd2IfItemThenVoucher> a ns1:Implies ;
    ns1:if [ a ns1:Exists ;
            ns1:formula [ a ns1:And ;
                    ns1:formulas ( [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "customer" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2shoppingCart"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Var ;
                                                    ns1:varname "shoppingCart" ] ] ) ] [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "shoppingCart" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2containsItem"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Var ;
                                                    ns1:varname "item" ] ] ) ] [ a ns1:Member ;
                                ns1:class [ a ns1:Const ;
                                        ns1:constIRI "http://example.com/2009/prd2Widget"^^xsd:anyURI ] ;
                                ns1:instance [ a ns1:Var ;
                                        ns1:varname "item" ] ] ) ] ;
            ns1:vars ( [ a ns1:Var ;
                        ns1:varname "shoppingCart" ] [ a ns1:Var ;
                        ns1:varname "item" ] ) ] ;
    ns1:then [ a ns1:Do ;
            ns1:actionVar ( [ a ns1:Var ;
                        ns1:varname "s" ] [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "customer" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2shoppingCart"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Var ;
                                            ns1:varname "s" ] ] ) ]), ([ a ns1:Var ;
                        ns1:varname "val" ] [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "s" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2value"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Var ;
                                            ns1:varname "val" ] ] ) ] ) ;
            ns1:actions ( [ a ns1:Retract ;
                        ns1:target ( [ a ns1:Var ;
                                    ns1:varname "customer" ] [ a ns1:Const ;
                                    ns1:constIRI "http://example.com/2009/prd2voucher"^^xsd:anyURI ] ) ] [ a ns1:Modify ;
                        ns1:target [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "s" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2value"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:External ;
                                                    ns1:content [ a ns1:Expr ;
                                                            ns1:args ( [ a ns1:Var ;
                                                                        ns1:varname "val" ] [ a ns1:Const ;
                                                                        ns1:value 0.90 ] ) ;
                                                            ns1:op [ a ns1:Const ;
                                                                    ns1:constIRI "http://www.w3.org/2007/rif-builtin-function#numeric-multiply"^^xsd:anyURI ] ] ] ] ) ] ] ) ] .

<http://example.com/2009/prd2IfMedalDoDiscount> a ns1:Implies ;
    ns1:if [ a ns1:Or ;
            ns1:formulas ( [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "customer" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Const ;
                                            ns1:value "Silver"^^xsd:string ] ] ) ] [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "customer" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Const ;
                                            ns1:value "Gold"^^xsd:string ] ] ) ] ) ] ;
    ns1:then [ a ns1:Do ;
            ns1:actionVar ( [ a ns1:Var ;
                        ns1:varname "s" ] [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "customer" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2shoppingCart"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Var ;
                                            ns1:varname "s" ] ] ) ]), ([ a ns1:Var ;
                        ns1:varname "v" ] [ a ns1:Frame ;
                        ns1:object [ a ns1:Var ;
                                ns1:varname "s" ] ;
                        ns1:slots ( [ a ns1:Slot ;
                                    ns1:slotkey [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2value"^^xsd:anyURI ] ;
                                    ns1:slotvalue [ a ns1:Var ;
                                            ns1:varname "v" ] ] ) ] ) ;
            ns1:actions ( [ a ns1:Modify ;
                        ns1:target [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "s" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2value"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:External ;
                                                    ns1:content [ a ns1:Expr ;
                                                            ns1:args ( [ a ns1:Var ;
                                                                        ns1:varname "v" ] [ a ns1:Const ;
                                                                        ns1:value 0.95 ] ) ;
                                                            ns1:op [ a ns1:Const ;
                                                                    ns1:constIRI "http://www.w3.org/2007/rif-builtin-function#numeric-multiply"^^xsd:anyURI ] ] ] ] ) ] ] ) ] .

<http://example.com/2009/prd2IfNoMedalThenNewCustomer> a ns1:Implies ;
    ns1:if [ a ns1:INeg ;
            ns1:formula [ a ns1:Exists ;
                    ns1:formula [ a ns1:And ;
                            ns1:formulas ( [ a ns1:Frame ;
                                        ns1:object [ a ns1:Var ;
                                                ns1:varname "customer" ] ;
                                        ns1:slots ( [ a ns1:Slot ;
                                                    ns1:slotkey [ a ns1:Const ;
                                                            ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                                    ns1:slotvalue [ a ns1:Var ;
                                                            ns1:varname "status" ] ] ) ] [ a ns1:External ;
                                        ns1:content [ a ns1:Atom ;
                                                ns1:args ( [ a ns1:List ;
                                                            ns1:items ( [ a ns1:Const ;
                                                                        ns1:value "New"^^xsd:string ] [ a ns1:Const ;
                                                                        ns1:value "Bronze"^^xsd:string ] [ a ns1:Const ;
                                                                        ns1:value "Silver"^^xsd:string ] [ a ns1:Const ;
                                                                        ns1:value "Gold"^^xsd:string ] ) ] [ a ns1:Var ;
                                                            ns1:varname "status" ] ) ;
                                                ns1:op [ a ns1:Const ;
                                                        ns1:constIRI "http://www.w3.org/2007/rif-builtin-predicate#list-contains"^^xsd:anyURI ] ] ] ) ] ;
                    ns1:vars ( [ a ns1:Var ;
                                ns1:varname "status" ] ) ] ] ;
    ns1:then [ a ns1:Do ;
            ns1:actions ( [ a ns1:Execute ;
                        ns1:target [ a ns1:Atom ;
                                ns1:args ( [ a ns1:External ;
                                            ns1:content [ a ns1:Expr ;
                                                    ns1:args ( [ a ns1:Const ;
                                                                ns1:value "New customer: "^^xsd:string ] [ a ns1:Var ;
                                                                ns1:varname "customer" ] ) ;
                                                    ns1:op [ a ns1:Const ;
                                                            ns1:constIRI "http://www.w3.org/2007/rif-builtin-function#concat"^^xsd:anyURI ] ] ] ) ;
                                ns1:op [ a ns1:Const ;
                                        ns1:constIRI "http://www.w3.org/2007/rif-builtin-action#print"^^xsd:anyURI ] ] ] [ a ns1:Assert ;
                        ns1:target [ a ns1:Frame ;
                                ns1:object [ a ns1:Var ;
                                        ns1:varname "customer" ] ;
                                ns1:slots ( [ a ns1:Slot ;
                                            ns1:slotkey [ a ns1:Const ;
                                                    ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                            ns1:slotvalue [ a ns1:Const ;
                                                    ns1:value "New"^^xsd:string ] ] ) ] ] ) ] .

<http://example.com/2009/prd2NewCustomerAndWidgetRule> a ns1:Group ;
    ns1:sentences ( [ a ns1:Forall ;
                ns1:formula <http://example.com/2009/prd2IfItemThenVoucher> ;
                ns1:pattern [ a ns1:And ;
                        ns1:formulas ( [ a ns1:Member ;
                                    ns1:class [ a ns1:Const ;
                                            ns1:constIRI "http://example.com/2009/prd2Customer"^^xsd:anyURI ] ;
                                    ns1:instance [ a ns1:Var ;
                                            ns1:varname "customer" ] ] [ a ns1:Frame ;
                                    ns1:object [ a ns1:Var ;
                                            ns1:varname "customer" ] ;
                                    ns1:slots ( [ a ns1:Slot ;
                                                ns1:slotkey [ a ns1:Const ;
                                                        ns1:constIRI "http://example.com/2009/prd2status"^^xsd:anyURI ] ;
                                                ns1:slotvalue [ a ns1:Const ;
                                                        ns1:value "New"^^xsd:string ] ] ) ] ) ] ;
                ns1:vars ( [ a ns1:Var ;
                            ns1:varname "customer" ] ) ] ) .

<http://example.com/2009/prd2UnknownStatusRule> a ns1:Group ;
    ns1:sentences ( [ a ns1:Forall ;
                ns1:formula <http://example.com/2009/prd2IfNoMedalThenNewCustomer> ;
                ns1:pattern [ a ns1:Member ;
                        ns1:class [ a ns1:Const ;
                                ns1:constIRI "http://example.com/2009/prd2Customer"^^xsd:anyURI ] ;
                        ns1:instance [ a ns1:Var ;
                                ns1:varname "customer" ] ] ;
                ns1:vars ( [ a ns1:Var ;
                            ns1:varname "customer" ] ) ] ) .

[] a ns1:Document ;
    ns1:payload <http://example.com/2009/prd2CheckoutRuleset> .
